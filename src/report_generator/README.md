# Report Generator

Works in these phases: 

1. Prepare Phase: Runs SQL queries to update the latest summary row
    At the end of the scanning pipeline, an entry for this scan already exists in the summary table in the database (inserted during scanning) to represent that specific scan. This prepare phase builds on this entry and populates the remaining statistical fields by running database queries that aggregate data from the hosts and ports tables. 
    Queries are filtered by country and scan timestamps, matching the scan's recorded times in the summary entry.

2. Create Report Phase: Generate the report using the LaTeX report generator
    The report generated for each scanned CIDR block (from all database tables) is made with the network administrator in mind.
    The Summary table is then reviewed to extract aggregate statistics from the nationwide scan. This report provides a high-level overview of the scan and is intended for the project supervisor.

3. Send the report via mail service
    Once generated, the reports are emailed directly to the stakeholder by the Mail Server

4. Back up the report to MinIO using mc
    Uses a script that utilizes Duplicity and GPG keys to encrypt the report before sending to the backup bucket.


* **Supervisor Summaries**: One summary per country (top open ports, services, OS counts).
* **Detailed Reports**: One per CIDR block (per‑IP port exposure details).

---

## Prerequisites

1. Python 3.8+

**Dependencies** 
(install via `pip install -r requirements.txt`):

sudo apt install texlive-full

`psycopg2` (Postgres client)

`pyffx` (format-preserving IP encryption)




## Environment Variables

Ensure the following are set (usually in a `.env` at project root):

```bash
# Database credentials
DB_HOST=<host>
DB_PORT=<port>
DB_USER=<user>
DB_PASS=<password>
DB_NAME=<database>

# IP encryption (must match ScanICE encryption)
FPE_KEY=<your_fpe_key>
FPE_ALPHABET=<fpe_alphabet>
FPE_LENGTH=<fpe_length>
```

Load them before running:

```bash
source .env
```



## Customization

Configurations happen in /config.py

Feel free to  modify the LaTeX templates under `templates/` to adjust styling, branding, or content.




> *Generated by Völva Report Generator*
